<!DOCTYPE HTML>
<!--
	Solid State by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>

<head>
	<title>AI-Learning - PYTHON Section 9</title>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
	<link rel="stylesheet" href="/assets/css/main.css" />
	<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.7.2/styles/dracula.min.css">
	<noscript>
		<link rel="stylesheet" href="/assets/css/noscript.css" />
	</noscript>
</head>

<body class="is-preload">

	<!-- Page Wrapper -->
	<div id="page-wrapper">

		<!-- Header -->
		<header id="header" class="alt" style="display: flex; align-items: center;">
			<a href="/index.html" style="text-decoration: none; border: none; outline: none;">
				<img src="/images/ai-learning-logo.svg" alt="Votre Logo" style="display: block; border: none;">
			</a>
			<nav>
				<a href="#menu">Menu</a>
			</nav>
		</header>

		<!-- Menu -->
		<nav id="menu">
			<div class="inner">
				<h2>Menu</h2>
				<ul class="links">
					<li><a href="/index.html">Accueil</a></li>
					<li><a href="/courses.html">Formations</a></li>
					<li><a href="/ai-learning.html">Qu'est ce qu'AI-Learning ?</a></li>
					<li><a href="/generation.html">Comment sont générer nos formations ?</a></li>
					<li><a href="/research.html">Travail de recherche</a></li>
				</ul>
				<a href="#" class="close">Close</a>
			</div>
		</nav>

		<!-- Wrapper -->
		<section id="wrapper">
			<header>
				<div class="inner">
					<h2>Section 6: Accès aux données avec ADO.NET</h2>
					<a href="/AI-Learning/c%23/c%23.html"
						class="button primary">
						Retour au cours </a>
				</div>
			</header>
			<!-- Content -->
			<div class="wrapper">
				<div class="inner">
					

<h2>Introduction à ADO.NET</h2>
<p>ADO.NET est une technologie de Microsoft qui permet d'accéder aux données et de les manipuler dans les applications C#. Il fournit un ensemble de classes et de méthodes pour se connecter à une base de données, exécuter des requêtes et récupérer les résultats.</p>
<p>ADO.NET est basé sur le modèle de programmation orientée objet, ce qui signifie que les données sont représentées sous forme d'objets dans le code. Il offre une grande flexibilité et une performance élevée pour le traitement des données.</p>

<h2>Connexion à une base de données</h2>
<p>Pour se connecter à une base de données avec ADO.NET, nous devons utiliser la classe SqlConnection. Voici un exemple de code qui montre comment établir une connexion à une base de données :</p>
<pre><code>string connectionString = "Data Source=nomServeur;Initial Catalog=nomBaseDeDonnées;User ID=nomUtilisateur;Password=motDePasse";
SqlConnection connection = new SqlConnection(connectionString);
connection.Open();
</code></pre>
<p>Dans cet exemple, nous spécifions les informations de connexion dans la chaîne de connexion, puis nous créons une instance de la classe SqlConnection en passant cette chaîne de connexion en tant que paramètre du constructeur. Enfin, nous ouvrons la connexion en appelant la méthode Open() de l'objet SqlConnection.</p>

<h2>Lecture et écriture de données</h2>
<p>Une fois que nous sommes connectés à une base de données, nous pouvons exécuter des requêtes pour lire et écrire des données. Pour cela, nous utilisons la classe SqlCommand.</p>
<p>Voici un exemple de code qui montre comment exécuter une requête SELECT pour lire des données à partir d'une table :</p>
<pre><code>string query = "SELECT * FROM nomTable";
SqlCommand command = new SqlCommand(query, connection);
SqlDataReader reader = command.ExecuteReader();

while (reader.Read())
{
    // Lire les données et les traiter
}

reader.Close();
</code></pre>
<p>Dans cet exemple, nous spécifions la requête SELECT dans une chaîne de caractères, puis nous créons une instance de la classe SqlCommand en passant cette requête et l'objet SqlConnection en tant que paramètres du constructeur. Ensuite, nous exécutons la requête en appelant la méthode ExecuteReader() de l'objet SqlCommand, qui renvoie un objet SqlDataReader contenant les résultats de la requête. Enfin, nous parcourons les lignes du résultat en appelant la méthode Read() de l'objet SqlDataReader.</p>
<p>Pour exécuter une requête INSERT, UPDATE ou DELETE pour écrire des données dans une table, nous utilisons la méthode ExecuteNonQuery() de l'objet SqlCommand. Voici un exemple :</p>
<pre><code>string query = "INSERT INTO nomTable (colonne1, colonne2) VALUES (@valeur1, @valeur2)";
SqlCommand command = new SqlCommand(query, connection);
command.Parameters.AddWithValue("@valeur1", valeur1);
command.Parameters.AddWithValue("@valeur2", valeur2);
command.ExecuteNonQuery();
</code></pre>
<p>Dans cet exemple, nous spécifions la requête INSERT dans une chaîne de caractères, puis nous créons une instance de la classe SqlCommand en passant cette requête et l'objet SqlConnection en tant que paramètres du constructeur. Ensuite, nous utilisons la méthode Parameters.AddWithValue() pour spécifier les valeurs des paramètres de la requête. Enfin, nous exécutons la requête en appelant la méthode ExecuteNonQuery() de l'objet SqlCommand.</p>

<h2>Utilisation des transactions</h2>
<p>Les transactions sont utilisées pour regrouper plusieurs opérations de base de données en une seule unité logique. Cela permet d'assurer l'intégrité des données et de maintenir la cohérence de la base de données.</p>
<p>Pour utiliser des transactions avec ADO.NET, nous utilisons la classe SqlTransaction. Voici un exemple de code qui montre comment exécuter plusieurs requêtes dans une transaction :</p>
<pre><code>SqlTransaction transaction = connection.BeginTransaction();

try
{
    string query1 = "INSERT INTO nomTable (colonne1) VALUES (@valeur1)";
    SqlCommand command1 = new SqlCommand(query1, connection, transaction);
    command1.Parameters.AddWithValue("@valeur1", valeur1);
    command1.ExecuteNonQuery();

    string query2 = "UPDATE nomTable SET colonne2 = @valeur2 WHERE colonne1 = @valeur1";
    SqlCommand command2 = new SqlCommand(query2, connection, transaction);
    command2.Parameters.AddWithValue("@valeur1", valeur1);
    command2.Parameters.AddWithValue("@valeur2", valeur2);
    command2.ExecuteNonQuery();

    transaction.Commit();
}
catch (Exception ex)
{
    transaction.Rollback();
    // Gérer l'erreur
}
</code></pre>
<p>Dans cet exemple, nous commençons par appeler la méthode BeginTransaction() de l'objet SqlConnection pour démarrer une nouvelle transaction. Ensuite, nous exécutons les requêtes INSERT et UPDATE à l'intérieur de la transaction en passant l'objet transaction en tant que paramètre du constructeur de la classe SqlCommand. Enfin, nous appelons la méthode Commit() de l'objet SqlTransaction pour valider la transaction, ou la méthode Rollback() pour l'annuler en cas d'erreur.</p>

<p>Ceci conclut la section sur l'accès aux données avec ADO.NET. Nous avons appris comment se connecter à une base de données, exécuter des requêtes pour lire et écrire des données, et utiliser des transactions pour regrouper plusieurs opérations. Ces connaissances sont essentielles pour développer des applications C# qui interagissent avec des bases de données.</p>
					<a href="/AI-Learning/c%23/c%23.html"
						class="button primary">
						Retour au cours </a>
				</div>
			</div>
		</section>

		<!-- Footer -->
		<section id="footer">
			<div class="inner">
				<ul class="copyright">
					<li>&copy; Untitled Inc. All rights reserved.</li>
					<li>Design: <a href="http://html5up.net">HTML5 UP</a></li>
				</ul>
			</div>
		</section>

	</div>

	<!-- Scripts -->
	<script src="/assets/js/jquery.min.js"></script>
	<script src="/assets/js/jquery.scrollex.min.js"></script>
	<script src="/assets/js/browser.min.js"></script>
	<script src="/assets/js/breakpoints.min.js"></script>
	<script src="/assets/js/util.js"></script>
	<script src="/assets/js/main.js"></script>
	<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.7.2/highlight.min.js"></script>
	<script>hljs.highlightAll();</script>

</body>

</html>